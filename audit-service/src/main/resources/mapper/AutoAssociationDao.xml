<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zpepdi.audit_service.dao.AutoAssociationDao">
    <select id="queryBySelf" resultType="java.util.Map">
        SELECT
            ai.id,
            ai.state,
            ai.initiator_id,
            ai.initiator_username,
            ai.initiator_name,
            cast(ai.initiate_time as char(10)) as initiate_time,
            ai.information,
            ai.type,
            ai.alive,
            ai.is_seen,
            ri.id AS atr_id,
            ri.auditor_id,
            ri.auditor_username,
            ri.auditor_name,
            ri.remark,
            ri.state AS atr_remark
        FROM
            audit_information ai,
            auditor_information ri,
            auto_association a
        WHERE
            a.viewer_id = #{id}
          AND a.type = ai.type
          AND a.associated_id = ri.auditor_id
          and ai.id = ri.audit_information_id
          AND ri.state > 0
    </select>
</mapper>